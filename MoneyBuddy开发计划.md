# MoneyBuddy - iOSæ™ºèƒ½è®°è´¦è½¯ä»¶å¼€å‘è®¡åˆ’

> ç›®æ ‡å¹³å°ï¼šiOS 15.0+ (ä¸­å›½åŒºApp Store)  
> å¼€å‘æ–¹å¼ï¼šVibe Coding + GitHubäº‘ç«¯æ‰˜ç®¡  
> æŠ€æœ¯æ–¹æ¡ˆï¼šè½»æ•²èƒŒé¢OCR + é“¶è¡ŒçŸ­ä¿¡è‡ªåŠ¨è§£æ + DeepSeek AI + Live2D

---

## ä¸€ã€æŠ€æœ¯æ–¹æ¡ˆ

### 1.1 æ•°æ®é‡‡é›†

| æ–¹æ¡ˆ | è§¦å‘æ–¹å¼ | è‡ªåŠ¨åŒ– | ä¼˜å…ˆçº§ |
|-----|---------|-------|-------|
| è½»æ•²èƒŒé¢OCR | æ•²ä¸¤ä¸‹èƒŒé¢ | åŠè‡ªåŠ¨ | P0 |
| é“¶è¡ŒçŸ­ä¿¡è§£æ | æ”¶çŸ­ä¿¡è‡ªåŠ¨è§¦å‘ | å…¨è‡ªåŠ¨ | P0 |
| CSVè´¦å•å¯¼å…¥ | æ‰‹åŠ¨å¯¼å…¥ | æ‰‹åŠ¨ | P1 |
| æ‰‹åŠ¨è®°è´¦ | æ‰“å¼€APPè¾“å…¥ | æ‰‹åŠ¨ | P1 |

### 1.2 AIé›†æˆ

| åŠŸèƒ½ | æ¨¡å‹ | ç”¨é€” |
|-----|------|------|
| æ™ºèƒ½åˆ†ç±» | `deepseek-chat` | å•†å®¶åç§°â†’åˆ†ç±» |
| å‘¨æŠ¥åˆ†æ | `deepseek-reasoner` | æ¶ˆè´¹è¶‹åŠ¿æ´å¯Ÿ |
| å¯¹è¯äº’åŠ¨ | `deepseek-chat` | å›ç­”è´¦å•é—®é¢˜ |

### 1.3 ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·è§¦å‘å±‚                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è½»æ•²æ‰‹æœºèƒŒé¢    â”‚    é“¶è¡ŒçŸ­ä¿¡åˆ°è¾¾   â”‚      æ‰‹åŠ¨æ“ä½œ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼                  â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      iOS å¿«æ·æŒ‡ä»¤å±‚                              â”‚
â”‚  [æˆªå±] â†’ [OCRæå–] â†’ [URL Schemeä¼ é€’]                          â”‚
â”‚  [çŸ­ä¿¡] â†’ [æ­£åˆ™è§£æ] â†’ [URL Schemeä¼ é€’]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       MoneyBuddy App                            â”‚
â”‚  URL Handler â†’ Parser â†’ DeepSeek AI â†’ SwiftData â†’ UI           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€åŠŸèƒ½æ¨¡å—

### 2.1 è½»æ•²èƒŒé¢OCRè®°è´¦

**ç”¨æˆ·æµç¨‹ï¼š**
```
æ”¯ä»˜å®Œæˆ â†’ åœç•™è¯¦æƒ…é¡µ â†’ æ•²ä¸¤ä¸‹èƒŒé¢ â†’ æˆªå±OCR â†’ APPé¢„å¡«è¡¨å• â†’ ç¡®è®¤ä¿å­˜
```

**å¿«æ·æŒ‡ä»¤ï¼š**
```yaml
åç§°: MoneyBuddyè®°è´¦
è§¦å‘: è½»ç‚¹èƒŒé¢ä¸¤ä¸‹
æ­¥éª¤:
  1. æˆªå±
  2. ä»æˆªå±æå–æ–‡æœ¬
  3. æ‹·è´åˆ°å‰ªè´´æ¿
  4. æ‰“å¼€URL: moneybuddy://ocr-record
```

**è§£æä»£ç ï¼š**
```swift
struct TransactionParser {
    static func parse(_ text: String) -> ParsedTransaction {
        var result = ParsedTransaction()
        
        // è¯†åˆ«å¹³å°
        if text.contains("å¾®ä¿¡") { result.source = .wechat }
        else if text.contains("æ”¯ä»˜å®") { result.source = .alipay }
        
        // æå–é‡‘é¢
        let patterns = [
            "Â¥([0-9]+\\.?[0-9]*)",
            "([0-9]+\\.?[0-9]*)å…ƒ",
            "æ”¯ä»˜é‡‘é¢.*?([0-9]+\\.[0-9]{2})"
        ]
        result.amount = extractFirst(text, patterns: patterns)
        
        // æå–å•†å®¶
        let merchantPatterns = [
            "æ”¶æ¬¾æ–¹[ï¼š:]?(.+?)(?:\n|$)",
            "ä»˜æ¬¾ç»™[ï¼š:]?(.+?)(?:\n|$)"
        ]
        result.merchant = extractFirst(text, patterns: merchantPatterns)
        
        return result
    }
}
```

### 2.2 é“¶è¡ŒçŸ­ä¿¡è‡ªåŠ¨è®°è´¦

**æ”¯æŒé“¶è¡Œï¼š**
```swift
enum BankSMS: String, CaseIterable {
    case icbc = "95588"      // å·¥å•†é“¶è¡Œ
    case ccb = "95533"       // å»ºè®¾é“¶è¡Œ
    case abc = "95599"       // å†œä¸šé“¶è¡Œ
    case boc = "95566"       // ä¸­å›½é“¶è¡Œ
    case cmb = "95555"       // æ‹›å•†é“¶è¡Œ
    case comm = "95559"      // äº¤é€šé“¶è¡Œ
    case citic = "95558"     // ä¸­ä¿¡é“¶è¡Œ
    case spdb = "95528"      // æµ¦å‘é“¶è¡Œ
    case ceb = "95595"       // å…‰å¤§é“¶è¡Œ
}
```

**å¿«æ·æŒ‡ä»¤è‡ªåŠ¨åŒ–ï¼š**
```yaml
åç§°: é“¶è¡ŒçŸ­ä¿¡è‡ªåŠ¨è®°è´¦
è§¦å‘: æ”¶åˆ°ä¿¡æ¯ (å‘é€è€…: 95588, 95533, 95599...)
æ­¥éª¤:
  1. è·å–çŸ­ä¿¡å†…å®¹
  2. åŒ¹é…: æ”¯å‡º.*?([0-9]+\.?[0-9]*)å…ƒ?|äººæ°‘å¸-?([0-9]+\.?[0-9]*)
  3. å¦‚æœåŒ¹é…æˆåŠŸ:
     - URLç¼–ç å†…å®¹
     - æ‰“å¼€: moneybuddy://sms-record?raw={å†…å®¹}
è®¾ç½®: è¿è¡Œå‰è¯¢é—®=å…³é—­ (iOS 17+)
```

**çŸ­ä¿¡è§£æï¼š**
```swift
class BankSMSParser {
    private let templates: [String: SMSTemplate] = [
        "icbc": SMSTemplate(
            amountPattern: "æ”¯å‡º\\(äººæ°‘å¸\\)([0-9]+\\.?[0-9]*)å…ƒ",
            merchantPattern: "åœ¨(.+?)æ¶ˆè´¹"
        ),
        "ccb": SMSTemplate(
            amountPattern: "æ”¯å‡ºäººæ°‘å¸([0-9]+\\.?[0-9]*)",
            merchantPattern: "(å¾®ä¿¡æ”¯ä»˜|æ”¯ä»˜å®|äº‘é—ªä»˜)"
        ),
        "cmb": SMSTemplate(
            amountPattern: "æ¶ˆè´¹.*?([0-9]+\\.?[0-9]*)å…ƒ",
            merchantPattern: "åœ¨(.+?)æ¶ˆè´¹"
        )
    ]
}
```

### 2.3 DeepSeekæ™ºèƒ½åˆ†ç±»

**æµç¨‹ï¼š**
```
å•†å®¶åç§° â†’ æœ¬åœ°å…³é”®è¯åŒ¹é… â†’ å‘½ä¸­åˆ™ä½¿ç”¨
              â†“ æœªå‘½ä¸­
        è°ƒç”¨DeepSeek API â†’ ç¼“å­˜ç»“æœ
```

**å…³é”®è¯é¢„è®¾ï¼š**
```swift
let keywords: [Category: [String]] = [
    .food: ["ç¾å›¢", "é¥¿äº†ä¹ˆ", "è‚¯å¾·åŸº", "éº¦å½“åŠ³", "æ˜Ÿå·´å…‹", "é¤å…"],
    .transport: ["æ»´æ»´", "é«˜å¾·", "åœ°é“", "å…¬äº¤", "åŠ æ²¹"],
    .shopping: ["æ·˜å®", "äº¬ä¸œ", "æ‹¼å¤šå¤š", "è¶…å¸‚"],
    .entertainment: ["ç”µå½±", "æ¸¸æˆ", "è§†é¢‘", "éŸ³ä¹"]
]
```

**APIè°ƒç”¨ï¼š**
```swift
class DeepSeekService {
    func classify(_ merchant: String) async -> Category {
        let prompt = """
        åˆ†ç±»åˆ°ï¼šé¤é¥®ã€äº¤é€šã€è´­ç‰©ã€å¨±ä¹ã€ä½æˆ¿ã€åŒ»ç–—ã€æ•™è‚²ã€æ”¶å…¥ã€å…¶ä»–
        äº¤æ˜“ï¼š\(merchant)
        åªå›å¤ç±»åˆ«åç§°ã€‚
        """
        let response = await chat(prompt, model: "deepseek-chat")
        return Category(rawValue: response.trimmed) ?? .other
    }
    
    func generateWeeklyReport(_ transactions: [Transaction]) async -> String {
        let prompt = """
        åˆ†ææ¶ˆè´¹è®°å½•ï¼Œç»™å‡ºï¼š1.æ¦‚å†µ 2.åˆ†ç±»å æ¯” 3.è¶‹åŠ¿ 4.çœé’±å»ºè®®
        è½»æ¾è¯­æ°”ï¼Œ200å­—ä»¥å†…ã€‚
        """
        return await chat(prompt, model: "deepseek-reasoner")
    }
}
```

### 2.4 Live2Då¡é€šå½¢è±¡

**è§’è‰²è®¾å®šï¼š**
- å½¢è±¡ï¼šå¯çˆ±å°ç®¡å®¶ï¼Œæ—¥ç³»Qç‰ˆ
- ä½ç½®ï¼šå¯¼èˆªæ ä¸‹æ–¹
- è¡¨æƒ…ï¼šé»˜è®¤ã€å¼€å¿ƒã€æƒŠè®¶ã€æ€è€ƒã€é¼“åŠ±

**äº¤äº’ï¼š**
| è§¦å‘ | å“åº” |
|-----|------|
| ç‚¹å‡» | çœ¨çœ¼æ‘‡å¤´ |
| é•¿æŒ‰ | å”¤èµ·å¯¹è¯ |
| è®°è´¦æˆåŠŸ | å¼€å¿ƒè¡¨æƒ… |
| å¤§é¢æ¶ˆè´¹ | æƒŠè®¶è¡¨æƒ… |
| å‘¨æœ«é¦–æ¬¡æ‰“å¼€ | å¼¹å‡ºå‘¨æŠ¥ |

---

## ä¸‰ã€æ•°æ®æ¨¡å‹

```swift
@Model
class Transaction {
    var id: UUID
    var amount: Decimal
    var type: TransactionType      // income / expense
    var category: Category
    var merchant: String?
    var note: String?
    var date: Date
    var source: DataSource         // ocr / sms / csv / manual
    var bankName: String?
    var cardSuffix: String?
    var aiClassified: Bool
    var createdAt: Date
}

enum Category: String, Codable, CaseIterable {
    case food = "é¤é¥®"          // ğŸ”
    case transport = "äº¤é€š"     // ğŸš—
    case shopping = "è´­ç‰©"      // ğŸ›’
    case entertainment = "å¨±ä¹" // ğŸ®
    case housing = "ä½æˆ¿"       // ğŸ 
    case medical = "åŒ»ç–—"       // ğŸ’Š
    case education = "æ•™è‚²"     // ğŸ“š
    case income = "æ”¶å…¥"        // ğŸ’°
    case other = "å…¶ä»–"         // ğŸ“¦
}

enum DataSource: String, Codable {
    case ocr = "å±å¹•è¯†åˆ«"
    case sms = "é“¶è¡ŒçŸ­ä¿¡"
    case csv = "è´¦å•å¯¼å…¥"
    case manual = "æ‰‹åŠ¨å½•å…¥"
}
```

---

## å››ã€é¡¹ç›®ç»“æ„

```
MoneyBuddy/
â”œâ”€â”€ App/
â”‚   â”œâ”€â”€ MoneyBuddyApp.swift
â”‚   â””â”€â”€ URLHandler.swift
â”œâ”€â”€ Features/
â”‚   â”œâ”€â”€ Dashboard/
â”‚   â”œâ”€â”€ Transaction/
â”‚   â”‚   â”œâ”€â”€ QuickRecordSheet.swift
â”‚   â”‚   â””â”€â”€ ManualRecordView.swift
â”‚   â”œâ”€â”€ Analytics/
â”‚   â”‚   â””â”€â”€ WeeklyReportView.swift
â”‚   â”œâ”€â”€ Character/
â”‚   â”‚   â”œâ”€â”€ CharacterView.swift
â”‚   â”‚   â””â”€â”€ ChatView.swift
â”‚   â””â”€â”€ Settings/
â”‚       â””â”€â”€ ShortcutGuideView.swift
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ Parser/
â”‚   â”‚   â”œâ”€â”€ TransactionParser.swift
â”‚   â”‚   â””â”€â”€ BankSMSParser.swift
â”‚   â”œâ”€â”€ AI/
â”‚   â”‚   â”œâ”€â”€ DeepSeekService.swift
â”‚   â”‚   â””â”€â”€ CategoryEngine.swift
â”‚   â””â”€â”€ Data/
â”‚       â””â”€â”€ TransactionStore.swift
â”œâ”€â”€ Models/
â”œâ”€â”€ Live2D/
â””â”€â”€ Resources/
    â””â”€â”€ BankSMSTemplates.json
```

---

## äº”ã€åŠŸèƒ½æ¸…å•

### P0 æ ¸å¿ƒ

- [ ] URL Schemeæ¥æ”¶ (`moneybuddy://`)
- [ ] äº¤æ˜“æ–‡æœ¬è§£æå™¨
- [ ] é“¶è¡ŒçŸ­ä¿¡è§£æå™¨
- [ ] å¿«é€Ÿç¡®è®¤Sheet
- [ ] äº¤æ˜“åˆ—è¡¨
- [ ] DeepSeekåˆ†ç±»
- [ ] æœ¬åœ°è§„åˆ™ç¼“å­˜
- [ ] å¿«æ·æŒ‡ä»¤å¼•å¯¼

### P1 å¢å¼º

- [ ] æ‰‹åŠ¨è®°è´¦
- [ ] CSVå¯¼å…¥
- [ ] ç»Ÿè®¡æŠ¥è¡¨
- [ ] å‘¨æŠ¥ç”Ÿæˆ
- [ ] åˆ†ç±»ç®¡ç†
- [ ] æ•°æ®å¯¼å‡º

### P2 ä½“éªŒ

- [ ] Live2Dè§’è‰²
- [ ] è¡¨æƒ…è”åŠ¨
- [ ] AIå¯¹è¯
- [ ] Widget
- [ ] å¤šè´¦æœ¬

---

## å…­ã€ä¸Šæ¶è¦æ±‚

### å¿…éœ€èµ„è´¨

| é¡¹ç›® | è¯´æ˜ |
|-----|------|
| Appleå¼€å‘è€…è´¦å· | $99/å¹´ |
| ICPå¤‡æ¡ˆå· | çº¦20å·¥ä½œæ—¥ |
| åŸŸå | éšç§æ”¿ç­–é¡µé¢ |
| æœåŠ¡å™¨ | å¤‡æ¡ˆéœ€è¦ |

### App Storeè¦æ±‚

- éšç§æ”¿ç­–URL (å¿…é¡»å¯è®¿é—®)
- è´¦å·æ³¨é”€åŠŸèƒ½ (è‹¥æœ‰è´¦å·)
- Appåç§°=å¤‡æ¡ˆåç§°
- æˆªå›¾: 6.7å¯¸ + 6.5å¯¸

### éšç§æ”¿ç­–è¦ç‚¹

```
æ•°æ®è¯´æ˜ï¼š
- å‰ªè´´æ¿ï¼šæ¥æ”¶å¿«æ·æŒ‡ä»¤OCRæ–‡æœ¬
- æœ¬åœ°å­˜å‚¨ï¼šäº¤æ˜“è®°å½•å­˜è®¾å¤‡
- APIè°ƒç”¨ï¼šDeepSeekåˆ†ç±»ï¼ˆå‘é€å•†å®¶åç§°ï¼‰
- æ— åå°æ”¶é›†
```

---

## ä¸ƒã€æˆæœ¬é¢„ç®—

### å¼€å‘æˆæœ¬

| é¡¹ç›® | è´¹ç”¨ |
|-----|------|
| Appleå¼€å‘è€… | Â¥688/å¹´ |
| Live2Dè§’è‰² | Â¥3000-8000 |
| åŸŸå | Â¥50/å¹´ |
| æœåŠ¡å™¨ | Â¥500/å¹´ |
| **é¦–å¹´** | **çº¦Â¥5000-10000** |

### è¿è¥æˆæœ¬ (æœˆå‡)

| é¡¹ç›® | è´¹ç”¨ |
|-----|------|
| DeepSeek API | Â¥50-300 |
| æœåŠ¡å™¨ | Â¥50 |
| **æœˆå‡** | **çº¦Â¥100-350** |

---

## å…«ã€å‚è€ƒèµ„æº

- [DeepSeek API](https://api-docs.deepseek.com/)
- [Live2D SDK](https://www.live2d.com/en/sdk/)
- [App Intents](https://developer.apple.com/documentation/appintents)
- [Vision OCR](https://developer.apple.com/documentation/vision/vnrecognizetextrequest)
